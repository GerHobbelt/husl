<!doctype html>
<head>
  <meta charset="utf-8">
  <title>HUSL - Human-friendly HSL</title>
  <meta name="description" content="">
  <meta name="author" content="Alexei Boronine">
  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="http://yandex.st/highlightjs/6.2/styles/monokai.min.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <a name="top"></a>
  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <ul class="nav">
          <li>
            <a href="#overview">Overview</a>
          </li>
          <li>
            <a href="#comparison">Comparison</a>
          </li>
          <li>
            <a href="#status">Status</a>
          </li>
          <li>
            <a href="#usage">Usage</a>
          </li>
        </ul>
        <ul class="nav pull-right">
          <li><a href="https://raw.github.com/boronine/husl/master/husl.js">husl.js</a></li>
          <li><a href="https://raw.github.com/boronine/husl/master/husl.min.js">husl.min.js</a></li>
        </ul>
      </div>
    </div>
  </div>
  <a href="https://github.com/boronine/husl"><img style="position: absolute; top: 40px; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
  <div class="container">
    <header class="top">
      <h1><em>HUSL</em></h1>
      <h2 class="tagline">
        <em>
          <span>H</span><span>u</span><span>m</span><span>a</span><span>n</span><span>-</span><span>f</span><span>r</span><span>i</span><span>e</span><span>n</span><span>d</span><span>l</span><span>y</span>
          <span>H</span><span>S</span><span>L</span>
        </em>
      </h2>
      <div class="row">
        <div class="span6 offset3">
          <pre class="tagline-code"><code class="javascript">$('.tagline span').each(function(index){
  $(this).css('color', $.husl.husl(index / 17 * 360, 90, 50));
});</code></pre>
        </div>
      </div>
    </header>
    <hr/>
    <div class="row">
      <div class="span8">
        <a name="overview" class="goto"></a>
        <h2>What is <abbr class="initialism">HUSL</abbr>?</h2>
        <p><abbr class="initialism">HUSL</abbr> is a <a href="http://boronine.com/2012/03/26/Color-Spaces-for-Human-Beings/">human-friendly</a> replacement for the <abbr class="initialism">HSL</abbr> color space. <abbr class="initialism">HSL</abbr> was designed back in the 70s to be computationally cheap. It is but a clever geometric transformation of the <abbr class="initialism">RGB</abbr> color space and it does not take into account the complexities of human color vision.</p>
        <p>There have long existed color spaces designed for perceptual uniformity. One of these color spaces is <a href="http://en.wikipedia.org/wiki/CIELUV"><abbr class="initialism">CIELUV</abbr></a> (and its cylindrically shaped brother <abbr class="initialism">CIE LCh<sub>uv</sub></abbr>). Like <abbr class="initialism">HSL</abbr>, it defines hue and lightness, but instead of saturation it defines chroma. The problem with its chroma component is that it doesn't fit into a specific range. This makes it very hard to define colors programmatically. <strong><abbr class="husl initialism">HUSL</abbr> is a modified version of the <abbr class="initialism">CIE LCh<sub>uv</sub></abbr> color space with a new saturation component</strong>.</p>
      </div>
      <div class="span4">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th></th>
              <th>HSL</th>
              <th>HUSL</th>
              <th>CIE LCh<sub>uv</sub></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>Lightness</th>
              <td><span class="label label-important">Relative</span></td>
              <td><span class="label label-success">Absolute</span></td>
              <td><span class="label label-success">Absolute</span></td>
            </tr>
            <tr>
              <th>Saturation<sup>*</sup></th>
              <td><span class="label label-important">Relative</span></td>
              <td><span class="label label-important">Relative</span></td>
              <td><span class="label label-success">Absolute</span></td>
            </tr>
            <tr>
              <th>Hue</th>
              <td><span class="label label-important">Non-uniform</span></td>
              <td><span class="label label-success">Uniform</span></td>
              <td><span class="label label-success">Uniform</span></td>
            </tr>
            <tr>
              <th>Component ranges</th>
              <td><span class="label label-success">Defined</span></td>
              <td><span class="label label-success">Defined</span></td>
              <td><span class="label label-important">Undefined</span></td>
            </tr>
            <tr>
              <td colspan="4">
                <sup>*</sup> Saturation and chroma are actually distinct concepts
              </td>
            </tbody>
          </table>
        </div>
      </div>
    <a name="comparison"></a>
    <div class="row">
      <div class="span4">
        <h2 class="center">HSL</h2>
        <canvas id="hsl" height="200" width="360" class="demo"></canvas>
      </div>
      <div class="span4">
        <h2 class="center">HUSL</h2>
        <canvas id="husl" height="200" width="360" class="demo"></canvas>
        <p><abbr class="initialism">HUSL</abbr> preserves the lightness and hue components of <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr> and stretches its chroma vertically so that every color has the same range, defined as a percentage.</p>
      </div>
      <div class="span4">
        <h2 class="center">CIE LCh<sub>uv</sub></h2>
        <canvas id="cielchuv" height="200" width="360" class="demo"></canvas>
        <p>The chroma component of <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr> is absolute. Unlike saturation you can use it to compare two different colors. The downside is that each color has a different chroma range.</p>
      </div>
    </div>
    <h2>Lightness</h2>
    <div class="row">
      <div class="span4">
        <canvas id="hsl_lightness" height="200" width="360" class="demo"></canvas>
      </div>
      <div class="span6">
        <p>Have you ever tried to use HSL to work out contrast? Define background and text colors? I know I have, with horrible results.</p>
        <p><i class="icon-hand-left"></i> This is why. Two different colors with the same lightness as defined by <abbr class="initialism">HSL</abbr> can actually have very different lightness. For this demo I am using <abbr class="initialism">CIE</abbr>'s definition of lightness. Both <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr> and <abbr class="initialism">HUSL</abbr> use this component, so their picture would be an even grey. This definition of lightness is based on experimental results, you will find that it works very well.</p>
      </div>
    </div>
    <div class="row">
      <div class="span8">
        <p style="margin-top:20px">Let's try to generate some random background colors:</p>
        <pre><code class="javascript">function randomHue() {
  return Math.floor(Math.random() * 360);
}
// HUSL demo
$(...).css('background-color', $.husl.husl(randomHue(), 90, 60));
// HSL demo
$(...).css('background-color', hslToHex(randomHue(), 90, 60));</code></pre>
      </div>
      <div class="span2">
        <button class="btn btn-large" id="demo1">Test HUSL</button>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
      </div>
      <div class="span2">
        <button class="btn btn-large" id="demo2">Test HSL</button>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
        <div class="demo">Lightness: 60%</div>
      </div>
    </div>
    <h2>Hue</h2>
    <div class="row">
      <div class="span8">
        <p><abbr class="initialism">HUSL</abbr>'s uniform hue means random colors will be truly random. Iterating over colors will also produce better results.</p>
        <pre><code class="javascript">// HUSL demo
$('#rainbow-husl div').each(function(index) {
  $(this).css('background-color', $.husl.husl(index * 12, 90, 60));
});
// HSL demo
$('#rainbow-hsl div').each(function(index) {
  $(this).css('background-color', hslToHex(index * 12, 90, 60));
});</code></pre>
      </div>
      <div class="span2" id="rainbow-husl">
        <h3 class="center"><abbr class="initialism">HUSL</abbr></h3>
      </div>
      <div class="span2" id="rainbow-hsl">
        <h3 class="center"><abbr class="initialism">HSL</abbr></h3>
      </div>
    </div>
    <h2>Chroma</h2>
    <div class="row">
      <div class="span4">
        <canvas id="hsl_chroma" height="200" width="360" class="demo"></canvas>
      </div>
      <div class="span4">
        <canvas id="husl_chroma" height="200" width="360" class="demo"></canvas>
        <p>Both <abbr class="initialism">HSL</abbr> and <abbr class="initialism">HUSL</abbr> have a distorted chroma map, this is a trade-off of their convenient shape. <abbr class="initialism">HUSL</abbr>'s chroma has more sudden shifts, perhaps it can be improved with a better scaling function. <a href="https://github.com/boronine/husl">Fork my code!</a></p>
      </div>
      <div class="span4">
        <canvas id="cielchuv_chroma" height="200" width="360" class="demo"></canvas>
        <p>The chroma component of <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr> is absolute. Unlike saturation you can use it to compare two different colors. The downside is that each color has a different chroma range.</p>
      </div>
    </div>
    <a name="status"></a>
    <h1>Status</h1>
    <div class="row">
      <div class="span6">
        <p><strong><abbr class="initialism">HUSL</abbr> is a work in progress.</strong> It works well already, but has some problems too. The project uses <a href="http://semver.org/">semantic versioning</a>, so any backwards-incompatible change will be marked clearly (by incrementing the x in x.y.z). I am not an expert on colors, so I greatly welcome anyone's insight. You can fork this project on <a href="https://github.com/boronine/husl">GitHub</a> or talk to me via <a href="mailto://alexei.boronine@gmail.com">email</a>. The code is released under the <a href="https://raw.github.com/boronine/husl/master/LICENSE">MIT</a> license, the math behind it is in the public domain.</p>
        <p>I think <abbr class="initialism">HUSL</abbr> could benefit from a better scaling function, I haven't yet found one that is simple and would work well. Another option for further development is to use <abbr class="initialism">CIECAM02</abbr> as the base color space, since it is more recent that <abbr class="initialism">CIELUV</abbr>.</p>
      </div>
      <div class="span3">
        <h4 class="center">Lightness: 10%</h4>
        <canvas id="husl_low" height="150" width="270" class="demo"></canvas>
      </div>
      <div class="span3">
        <h4 class="center">Lightness: 95%</h4>
        <canvas id="husl_high" height="150" width="270" class="demo"></canvas>
      </div>
    </div>
    <h2>How does <abbr class="initialism">HUSL</abbr> currently work?</h2>
    <div class="row">
      <div class="span6">
        <p><abbr class="initialism">HUSL</abbr> is defined as a conversion to and from <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr>. This conversion is a two step process. It requires:</p>
        <ol>
          <li>Finding the maximum chroma for a given lightness and hue</li>
          <li>Scaling the saturation to fit inside that chroma range (currently linear)</li>
        </ol>
        <p>Finding the maximum chroma involves building three functions that take <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr>'s components as input and return <abbr class="initialism">RGB</abbr> channel values, one for each channel. We equate each to 1 and 0, and solve the 6 resulting equations for C. When we plot the 6 solutions with a fixed lightness and hue for x, we get the picture on the right. As expected, it looks like <abbr class="initialism">CIE&nbsp;LCh<sub>uv</sub></abbr>.</p>
        <p>I used <a href="http://maxima.sourceforge.net/">Maxima</a> to build and solve these equations, and <a href="https://github.com/boronine/husl/blob/master/math.wxm">a wxMaxima file</a> is bundled with the code.</p>
      </div>
      <div class="span6">
        <img src="img/plot.png"/>
      </div>
    </div>
    <a name="usage"></a>
    <h1>Usage</h1>
    <div class="row">
      <div class="span8">
        <p><abbr class="initialism">HUSL</abbr> is written in CoffeeScript, you can use it server-side with <code>npm install husl</code> or client-side as a jQuery plugin&nbsp;(<code>$.husl</code>).</p>
        <dl>
          <dt>husl(hue, saturation, lightness, [rgb = false])</dt>
          <dd><i>hue</i> is a number between 0 and 360, <i>saturation</i> and <i>lightness</i> are numbers between 0 and 100. This function returns the resulting color as a hex string, unless <i>rgb</i> is passed as <i>true</i>, in which case it returns an array of <abbr class="initialism">RGB</abbr> components.</dd>
          <dt>rgb(red, green, blue)</dt>
          <dd><i>red</i>, <i>green</i> and <i>blue</i> are passed as numbers between 0 and 1. This function returns an array of <abbr class="initialism">HUSL</abbr> components as defined above.</dd>
          <dt>hex(hex)</dt>
          <dd>Like the above, except the color is passed in as a hex string.</dd>
        </dl>
        <p><abbr class="initialism">HUSL</abbr> can also be used as a <a href="http://learnboost.github.com/stylus/">Stylus</a> plugin. To use from command line, run stylus like this:</p>
        <pre><code class="bash">stylus &lt; input.styl &gt; output.css -u /path/to/husl.js</code></pre>
        <p>To use programmatically, do this:</p>
        <pre><code class="javascript">var husl = require('husl');
app.use(stylus.middleware({
  src: __dirname + '/app/views',
  dest: __dirname + '/public',
  compile: function(str, path) {
    return stylus(str)
      .set('filename', path)
      .use(husl());
  }
});</code></pre>
        <p>Now you can use <abbr class="initialism">HUSL</abbr> in your stylesheets!</p>
        <pre><code>.tinted(hue)
  background-color husl(hue, 90, 80)
  color husl(hue, 90, 10)</code></pre>
        <h3>Would you like to see a Ruby and Sass port?</h3>
        <br/>
      </div>
    </div>
    <hr/>
    <footer>© Copyright 2012 by Alexei Boronine. (<a href="https://twitter.com/#!/boronine">@boronine</a>)</footer>
  </div>
  <script src="http://yandex.st/highlightjs/6.2/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script src="js/jquery-1.7.2.min.js"></script>
  <script src="js/colorspaces.min.js"></script>
  <script src="js/husl.js"></script>
  <script src="js/main.js"></script>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31795350-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>
</body>
</html>
